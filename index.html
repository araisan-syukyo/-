<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <title>日本は世界の縮図？</title>

  <!-- スマホ対応 -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <!-- LeafletのCSS（CDN） -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />

  <style>
    /* 全画面表示＆グラデーション背景 */
    html, body {
      margin: 0; padding: 0;
      height: 100%;
      font-family: sans-serif;
      background: linear-gradient(160deg, #edf7fa 0%, #bee8fa 100%);
    }
    /* タイトルヘッダー */
    header {
      position: fixed; top: 0; width: 100%;
      display: flex; justify-content: space-between; align-items: center;
      padding: 1rem; background: rgba(255, 255, 255, 0.95);
      box-shadow: 0 2px 8px rgba(0,0,0,0.1); z-index: 999;
    }
    header h1 {
      margin: 0;
      font-size: 1.6rem;
      color: #333;
    }
    .btn-area {
      display: flex;
      gap: 0.5rem;
    }
    .tour-btn {
      padding: 0.5rem 1rem;
      border: none;
      border-radius: 4px;
      background-color: #67c0f5;
      color: #fff;
      font-size: 0.9rem;
      cursor: pointer;
      transition: background-color 0.3s ease;
    }
    .tour-btn:hover {
      background-color: #42b0ec;
    }
    /* 地図本体 */
    #map {
      width: 100%;
      height: calc(100% - 70px);
      margin-top: 70px;
    }
    /* 点滅アニメーション */
    @keyframes markerBlink {
      0%   { transform: scale(1);   filter: brightness(1); }
      50%  { transform: scale(1.3); filter: brightness(2); }
      100% { transform: scale(1);   filter: brightness(1); }
    }
    .leaflet-marker-pane .blink-marker {
      animation: markerBlink 1s ease-in-out infinite;
    }

    /* 停止メッセージ等を表示する簡易ステータス用 */
    #statusMessage {
      position: fixed;
      top: 120px; right: 10px;
      padding: 8px 16px;
      background: rgba(0,0,0,0.7);
      color: #fff;
      border-radius: 4px;
      z-index: 9999;
      display: none; /* 初期は非表示 */
    }
  </style>
</head>

<body>
<header>
  <h1>日本は世界の縮図？</h1>
  <div class="btn-area">
    <!-- 従来ツアー（日本⇔世界）ボタン -->
    <button id="auto-tour-btn" class="tour-btn" onclick="startAutoTour()">自動ツアー</button>
    <button id="stop-btn" class="tour-btn" style="display:none;" onclick="stopAutoTour()">停止</button>

    <!-- 万国巡幸ツアーボタン -->
    <button id="ancient-tour-btn" class="tour-btn" onclick="startAncientTour()">
      万国巡幸ツアー(竹内文書の記録による上古第三代・天日豊本黄人皇主神天皇の万国巡幸)
    </button>
    <button id="ancient-stop-btn" class="tour-btn" style="display:none;" onclick="stopAncientTour()">
      停止
    </button>
  </div>
</header>

<div id="map"></div>
<div id="statusMessage"></div>

<!-- LeafletのJS（CDN） -->
<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>

<!-- 
  注意:
   このファイルの JavaScript/CSS/HTML コードは MITライセンスとしますが、
   以下 "ancientTexts" に含まれる文章は 
   © 2024 皇祖皇太神宮, All Rights Reserved (MITライセンス対象外)
   となります。無断転載・改変は禁止とします。
-->
<script>
////////////////////////////////////////////////////////////////////////////////
// 1. 地図の初期化 (MITライセンス)
////////////////////////////////////////////////////////////////////////////////
const map = L.map("map").setView([36, 138], 5);
L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
  attribution: "&copy; OpenStreetMap contributors"
}).addTo(map);

////////////////////////////////////////////////////////////////////////////////
// 2. 従来ツアー: 日本は世界の縮図？ (MITライセンス)
////////////////////////////////////////////////////////////////////////////////
// pairs などのデータをここに含める（省略）

////////////////////////////////////////////////////////////////////////////////
// 3. 万国巡幸ツアー(竹内文書)の文章 (© 2024 皇祖皇太神宮)
////////////////////////////////////////////////////////////////////////////////
/*
  ancientTexts は
  © 2024 皇祖皇太神宮, All rights reserved. (MITライセンス対象外)
  無断の複製・改変・翻案を禁じます。
*/

const ancientTexts = [
  {
    title: "① 鎮江・チェンヤン(南京のそば)",
    text: `© 2024 皇祖皇太神宮, All Rights Reserved (MIT除外)
支那王盤邦王民、天皇御膳に唐みしを献ず。
天皇詔して支那国主に命ず`
  },
  {
    title: "② 保定(北京と天津のそば)",
    text: `© 2024 皇祖皇太神宮, All Rights Reserved (MIT除外)
ヨイモツアダムイブヒアカヒ女氏五色人
早刻に来りて、
黄人皇主天皇に草花を奉献。
天皇詔して、アカヒ女氏別五色人
居る所の国王に任ず`
  },
  {
    title: "③ イタリヤのウェネチャ(ベニスのこと)",
    text: `© 2024 皇祖皇太神宮, All Rights Reserved (MIT除外)
アフリカのネネアホマ浜(ギニアの近く)
アフリアビシアム民王、
アスカリトキンコンコク主民王。
天日豊本黄人皇主天皇へキバナを奉献。
詔して国王に任ず`
  },
  {
    title: "④ オセアニアのメルボルン浜",
    text: `© 2024 皇祖皇太神宮, All Rights Reserved (MIT除外)
ハウライムタイ尊者、ダイビ民玉、
天皇大前に礼をす。天皇詔して国主に命ず`
  },
  {
    title: "⑤ 南アメリカのラブラタ浜",
    text: `© 2024 皇祖皇太神宮, All Rights Reserved (MIT除外)
天皇御臨幸、ヒウケイヒロブラシルコ民王、
ヒウケフラジルバラ民王、
天皇大前参朝して地面図を奉献。
天皇詔して二人を国主に命ず`
  },
  {
    title: "⑥ 北米カナダのニトアーク浜",
    text: `© 2024 皇祖皇太神宮, All Rights Reserved (MIT除外)
天皇に、アヒイタマヲ王アカ民王、
エスキマルカス民王、参朝拝礼し、
天皇詔して国主に命ず。
此時よりカナイシ国と云う`
  },
  {
    title: "⑦ 常盤国おつき浜",
    text: `© 2024 皇祖皇太神宮, All Rights Reserved (MIT除外)
万国巡幸始より、千九百五十年目の
カナメツキマドノミツヒ、万国より、
吉道路常磐国大付浜に帰京。
其所を唐カラ帰里と名付ける`
  }
];

// === マーカー生成 (万国巡幸) ===
const redIcon = L.icon({
  iconUrl: "https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-red.png",
  shadowUrl: "https://unpkg.com/leaflet/dist/images/marker-shadow.png",
  iconSize: [25, 41],
  iconAnchor: [12, 41],
  popupAnchor: [1, -34],
  shadowSize: [41, 41]
});

const ancientMarkers = [];
ancientTexts.forEach((item, i) => {
  const popupHTML = `
    <b>${item.title}</b><br>
    ${item.text.replace(/\n/g, "<br>")}
  `;

  // サンプル座標
  const lat = 32 + i;   
  const lng = 120 + i;  
  const marker = L.marker([lat, lng], { icon: redIcon }).addTo(map);
  marker.bindPopup(popupHTML);

  ancientMarkers.push(marker);
});

// === 万国巡幸ツアー 自動巡回 ===
let ancientTourTimer = null;
let ancientTourIndex = 0;

function startAncientTour() {
  stopAncientTour();
  document.getElementById("ancient-tour-btn").style.display = "none";
  document.getElementById("ancient-stop-btn").style.display = "inline-block";

  ancientTourIndex = 0;
  moveAncientNext();
}

function moveAncientNext() {
  if (ancientTourIndex >= ancientMarkers.length) {
    ancientTourIndex = 0;
  }
  const marker = ancientMarkers[ancientTourIndex];
  const latLng = marker.getLatLng();
  map.flyTo([latLng.lat, latLng.lng], 6); 

  // 2秒後にポップアップを開き、6秒後に次へ
  setTimeout(() => {
    marker.openPopup();
    ancientTourTimer = setTimeout(() => {
      ancientTourIndex++;
      moveAncientNext();
    }, 6000); 
  }, 2000);
}

function stopAncientTour() {
  if (ancientTourTimer) {
    clearTimeout(ancientTourTimer);
    ancientTourTimer = null;
  }
  document.getElementById("ancient-stop-btn").style.display = "none";
  document.getElementById("ancient-tour-btn").style.display = "inline-block";

  removeAllAncientPopups();
  showStatusMessage("万国巡幸ツアーを停止しました。");
}

function removeAllAncientPopups() {
  ancientMarkers.forEach(m => m.closePopup());
}


////////////////////////////////////////////////////////////////////////////////
// 従来ツアー（省略） + ステータス表示
////////////////////////////////////////////////////////////////////////////////

function showStatusMessage(msg) {
  const statusEl = document.getElementById("statusMessage");
  statusEl.textContent = msg;
  statusEl.style.display = "block";

  setTimeout(() => {
    statusEl.style.display = "none";
  }, 3000);
}
</script>
</body>
</html>